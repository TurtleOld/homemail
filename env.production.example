# Production Environment Variables
# Copy this file to .env.production and fill in your values

# Mail Provider Configuration
# Options: stalwart, imap
MAIL_PROVIDER=stalwart

# Stalwart JMAP Configuration
# Для Docker Compose используйте внутренние имена сервисов:
STALWART_BASE_URL=http://stalwart:8080
STALWART_SMTP_HOST=stalwart
STALWART_SMTP_PORT=587
STALWART_SMTP_SECURE=false
STALWART_AUTH_MODE=oauth

# OAuth Configuration (требуется если STALWART_AUTH_MODE=oauth)
# STALWART_PUBLIC_URL - внешний публичный URL для OAuth (через reverse-proxy)
# ОБЯЗАТЕЛЬНО указать! Используется для нормализации OAuth endpoints в discovery response
# Это должен быть публичный HTTPS URL, доступный из интернета
# Пример: STALWART_PUBLIC_URL=https://example.com
STALWART_PUBLIC_URL=https://example.com
# OAUTH_DISCOVERY_URL - можно указать явно, иначе автоматически определяется:
# - Если STALWART_BASE_URL внутренний (stalwart, localhost, IP) - используется STALWART_BASE_URL
# - Иначе используется STALWART_PUBLIC_URL
# Discovery запрос идет через внутренний URL (если доступен), но endpoints нормализуются на публичные
# OAUTH_DISCOVERY_URL=http://stalwart:8080/.well-known/oauth-authorization-server
# Client ID для OAuth Device Flow (получить у администратора Stalwart)
OAUTH_CLIENT_ID=your-oauth-client-id

# Для внешнего Stalwart сервера используйте:
# STALWART_BASE_URL=http://stalwart:8080
# STALWART_SMTP_HOST=stalwart

# Application Configuration
NODE_ENV=production
PORT=3000
NEXT_PUBLIC_APP_URL=https://your-domain.com
ALLOWED_ORIGIN_HOSTS=your-domain.com

# Security Configuration
# SESSION_SECRET используется для шифрования данных сессии в куках
# Сгенерируйте случайный ключ: openssl rand -base64 32
# Пример: SESSION_SECRET=K8mN2pQ5rT9vW1xY4zA7bC0dE3fG6hI9jK2lM5nO8pQ1rS4tU7vW0xY3zA6bC9dE
SESSION_SECRET=your-random-secret-key-here

# HTTPS Configuration
USE_HTTPS=true

# Rate Limiting
# RATE_LIMIT_LOGIN_MAX=5
# RATE_LIMIT_LOGIN_WINDOW=900000
# RATE_LIMIT_BULK_MAX=10
# RATE_LIMIT_BULK_WINDOW=60000
# RATE_LIMIT_SEND_MAX=20
# RATE_LIMIT_SEND_WINDOW=60000
# RATE_LIMIT_API_MAX=100
# RATE_LIMIT_API_WINDOW=60000

# IP Whitelist/Blacklist (comma-separated, supports CIDR notation)
# RATE_LIMIT_IP_WHITELIST=192.168.1.0/24,10.0.0.1
# RATE_LIMIT_IP_BLACKLIST=1.2.3.4,5.6.7.8

# Brute Force Protection
# BRUTE_FORCE_MAX_ATTEMPTS_IP=10
# BRUTE_FORCE_MAX_ATTEMPTS_EMAIL=5
# BRUTE_FORCE_BLOCK_DURATION_IP=3600000
# BRUTE_FORCE_BLOCK_DURATION_EMAIL=900000
# BRUTE_FORCE_WINDOW=900000

# SSRF Protection
# ALLOWED_DOCKER_NETWORKS - разрешенные Docker сети для внутренних запросов (comma-separated, supports CIDR)
# Пример: ALLOWED_DOCKER_NETWORKS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
ALLOWED_DOCKER_NETWORKS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
# ALLOWED_EXTERNAL_DOMAINS - whitelist разрешенных внешних доменов (comma-separated)
# ALLOWED_EXTERNAL_DOMAINS=example.com,api.example.com

# Security Logging
# SECURITY_LOG_DIR - директория для логов безопасности (по умолчанию: data/security-logs)
# SECURITY_LOG_DIR=/app/data/security-logs
